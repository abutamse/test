<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>iPad Minecraft Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#87ceeb;
  touch-action:none;
}

/* DEBUG TEXT */
#debug {
  position:absolute;
  top:10px;
  left:10px;
  color:white;
  font-size:14px;
  z-index:10;
}

/* JOYSTICK */
#joy {
  position:absolute;
  bottom:30px;
  left:30px;
  width:120px;
  height:120px;
  border-radius:50%;
  background:rgba(0,0,0,0.4);
}
#stick {
  position:absolute;
  width:50px;
  height:50px;
  border-radius:50%;
  background:white;
  left:35px;
  top:35px;
}
</style>
</head>

<body>

<div id="debug">JS geladen</div>

<div id="joy">
  <div id="stick"></div>
</div>

<!-- THREE.JS DIREKT VOM CDN -->
<script src="https://unpkg.com/three@0.149.0/build/three.min.js"></script>

<script>
document.getElementById("debug").innerText = "Three geladen";

// ========= SCENE =========
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb);

const camera = new THREE.PerspectiveCamera(
  75,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);
camera.position.set(0, 3, 8);

// ========= RENDERER =========
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// ========= LIGHT =========
scene.add(new THREE.AmbientLight(0xffffff, 0.8));
const sun = new THREE.DirectionalLight(0xffffff, 1);
sun.position.set(10,20,10);
scene.add(sun);

// ========= BLOCK =========
const geo = new THREE.BoxGeometry(1,1,1);
const mat = new THREE.MeshLambertMaterial({color:0x00ff00});
const block = new THREE.Mesh(geo,mat);
block.position.set(0,0.5,0);
scene.add(block);

// EXTRA großer Boden (damit er NICHT zu übersehen ist)
const floor = new THREE.Mesh(
  new THREE.BoxGeometry(50,1,50),
  new THREE.MeshLambertMaterial({color:0x228b22})
);
floor.position.y = -0.5;
scene.add(floor);

document.getElementById("debug").innerText = "Blöcke erstellt";

// ========= JOYSTICK =========
const joy = document.getElementById("joy");
const stick = document.getElementById("stick");
let mx = 0, mz = 0;

joy.addEventListener("touchmove", e=>{
  const r = joy.getBoundingClientRect();
  const t = e.touches[0];
  const dx = t.clientX - (r.left + r.width/2);
  const dy = t.clientY - (r.top + r.height/2);

  const d = Math.min(40, Math.hypot(dx,dy));
  const a = Math.atan2(dy,dx);

  mx = Math.cos(a) * (d/40);
  mz = Math.sin(a) * (d/40);

  stick.style.left = 35 + mx*40 + "px";
  stick.style.top  = 35 + mz*40 + "px";
});

joy.addEventListener("touchend", ()=>{
  mx = mz = 0;
  stick.style.left = "35px";
  stick.style.top = "35px";
});

// ========= LOOP =========
function loop(){
  requestAnimationFrame(loop);
  camera.position.x += mx * 0.15;
  camera.position.z += mz * 0.15;
  renderer.render(scene,camera);
}
loop();
</script>

</body>
</html>
